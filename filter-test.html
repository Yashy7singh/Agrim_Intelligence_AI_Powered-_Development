<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Filter Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; }
        select, input { margin: 5px; padding: 5px; }
        button { margin: 5px; padding: 8px 15px; }
        .results { background: #f5f5f5; padding: 10px; margin: 10px 0; }
    </style>
</head>
<body>
    <h1>Filter Functionality Test</h1>
    
    <div class="test-section">
        <h2>Test Data</h2>
        <div id="test-data"></div>
    </div>
    
    <div class="test-section">
        <h2>Filters</h2>
        <label>Category: 
            <select id="category-filter">
                <option value="all">All</option>
                <option value="Food">Food</option>
                <option value="Transport">Transport</option>
                <option value="Entertainment">Entertainment</option>
                <option value="Bills">Bills</option>
                <option value="Shopping">Shopping</option>
                <option value="Other">Other</option>
            </select>
        </label>
        
        <label>From Date: <input type="date" id="from-date"></label>
        <label>To Date: <input type="date" id="to-date"></label>
        
        <button onclick="applyFilters()">Apply Filters</button>
        <button onclick="clearFilters()">Clear Filters</button>
    </div>
    
    <div class="test-section">
        <h2>Filtered Results</h2>
        <div id="results"></div>
    </div>

    <script>
        // Sample data
        const testExpenses = [
            { id: '1', category: 'Food', date: '2024-10-01', amountCents: 1250, description: 'Lunch' },
            { id: '2', category: 'Transport', date: '2024-10-02', amountCents: 3000, description: 'Gas' },
            { id: '3', category: 'Entertainment', date: '2024-10-03', amountCents: 1500, description: 'Movie' },
            { id: '4', category: 'Food', date: '2024-10-04', amountCents: 2500, description: 'Groceries' },
            { id: '5', category: 'Bills', date: '2024-10-05', amountCents: 5000, description: 'Electric' }
        ];

        let filters = { category: 'all', fromDate: '', toDate: '' };

        function displayTestData() {
            const html = testExpenses.map(e => 
                `<div>${e.date} - ${e.category} - $${(e.amountCents/100).toFixed(2)} - ${e.description}</div>`
            ).join('');
            document.getElementById('test-data').innerHTML = html;
        }

        function compareDateStrings(a, b) {
            if (a < b) return -1;
            if (a > b) return 1;
            return 0;
        }

        function getFilteredExpenses() {
            let list = testExpenses.slice();
            
            console.log('Starting with', list.length, 'expenses');
            console.log('Filters:', filters);

            if (filters.category && filters.category !== 'all') {
                const before = list.length;
                list = list.filter(e => e.category === filters.category);
                console.log(`Category filter: ${before} -> ${list.length}`);
            }
            
            if (filters.fromDate) {
                const before = list.length;
                list = list.filter(e => compareDateStrings(e.date, filters.fromDate) >= 0);
                console.log(`From date filter: ${before} -> ${list.length}`);
            }
            
            if (filters.toDate) {
                const before = list.length;
                list = list.filter(e => compareDateStrings(e.date, filters.toDate) <= 0);
                console.log(`To date filter: ${before} -> ${list.length}`);
            }

            return list;
        }

        function applyFilters() {
            filters.category = document.getElementById('category-filter').value;
            filters.fromDate = document.getElementById('from-date').value;
            filters.toDate = document.getElementById('to-date').value;
            
            const filtered = getFilteredExpenses();
            
            const html = filtered.length > 0 
                ? filtered.map(e => 
                    `<div>${e.date} - ${e.category} - $${(e.amountCents/100).toFixed(2)} - ${e.description}</div>`
                  ).join('')
                : '<div>No expenses match the current filters.</div>';
                
            document.getElementById('results').innerHTML = html;
            
            console.log('Applied filters:', filters);
            console.log('Results:', filtered.length, 'expenses');
        }

        function clearFilters() {
            document.getElementById('category-filter').value = 'all';
            document.getElementById('from-date').value = '';
            document.getElementById('to-date').value = '';
            filters = { category: 'all', fromDate: '', toDate: '' };
            applyFilters();
        }

        // Initialize
        displayTestData();
        applyFilters();
    </script>
</body>
</html>